!function(a){function b(b,c){a(c).append('<div class="scroom-square" id="'+b.id+'" positionx="'+b.left+'" positiony="'+b.top+'" style="left:'+b.left+"px; top:"+b.top+"px; width:"+b.width+"px; height:"+b.height+'px;"></div>')}function d(b){a("#"+b).on("scroll touchmove mousewheel",function(a){return a.preventDefault(),a.stopPropagation(),!1})}a.fn.scrollZoom=function(c){var p,q,r,s,t,u,v,w,e=this.attr("id"),f=a("#"+e).offset(),g=f.left,h=f.top,i="#"+e+" .scroom-map .scroom-img",j=!1,k=!1,l=!1,m=!1,n=!1,x="",y=a("#"+e).width(),z=a("#"+e).height();window.onload=function(a){C(a)};var A=a(i).css("background-image").replace(/url\((['"])?(.*?)\1\)/gi,"$2"),B=new Image;B.src=A,B.onload=function(){t=this.width,u=this.height},a(i).on({mousemove:function(b){k?m&&(a.fn.scrollZoom.draw(s,r,b.pageX,b.pageY,i,n,g,h,v,w),n=!1):j&&C(b),a.fn.scrollZoom.pointer(k,"area",i)},mousedown:function(b){s=b.pageX,r=b.pageY;var c=a(i).css("background-position").split(" ");if(v=c[0].slice(0,-2),w=c[1].slice(0,-2),"scroom-square"==b.target.className&&k){var d=b.target.id;a.fn.scrollZoom.remove(d)}else k?(m=!0,n=!0):(j=!0,m=!1),a.fn.scrollZoom.pointer(k,"area",i)},mouseup:function(b){if(m=!1,k){if(b.pageX==s&&b.pageY==r)return!1;a("#scroom-modal").modal()}else j=!1,a("html").css("cursor","auto"),a(".scroom-square").length>0&&a(".scroom-square").each(function(c,d){if(b.pageX==s&&b.pageY==r)return!1;var e=d.id,f=d.style.left.slice(0,-2),g=d.style.top.slice(0,-2),h=parseInt(p)+parseInt(f),i=parseInt(q)+parseInt(g);a("#"+e).css({left:h+"px",top:i+"px"})})}});var C=function(b){d(e);var c=s-b.pageX,f=r-b.pageY,g=a(i).css("background-position").split(" "),h=g[0].slice(0,-2),j=g[1].slice(0,-2);"50%"==g[0]&&(h=-t/2,j=-u/2,a(i).css("background-position",h+"px "+j+"px"));var k=parseInt(h)+parseInt(c),l=parseInt(j)+parseInt(f);k>0&&(k=0),l>0&&(l=0);var m=parseInt(t)-parseInt(y),n=parseInt(u)-parseInt(z);k<-m&&(k=-m),l<-n&&(l=-n),a(i).css("background-position",k+"px "+l+"px"),p=parseInt(k)-parseInt(v),q=parseInt(l)-parseInt(w)};"undefined"!=typeof c&&(x=c.boxes),a(x).each(function(){b(this,i)}),a(i).bind("mousewheel",function(b){var c=a(this).css("transform").split("(");c=c[1].split(", ");var d=parseFloat(c[0]),e=parseFloat(c[3]);b.originalEvent.wheelDelta/120>0?(d+=.2,e+=.2,a(this).css("transform","scale("+d+","+e+")")):(d-=.2,e-=.2,d<1&&(d=1),e<1&&(e=1),a(this).css("transform","scale("+d+","+e+")"))}),a("#"+e+" #scroom-modal button.close").click(function(b){a(i+" .scroom-square").last().remove()}),a("#"+e+" #scroom-form").submit(function(){return a.ajax({type:"POST",url:"",data:a("#"+e+" #scroom-form").serialize(),success:function(){}}),a("#"+e+" #scroom-modal").modal("hide"),!1}),a("#"+e+" .scroom-options .scroom-area").click(function(){var b=a(this).attr("selection");"disabled"==b?(a(this).attr("selection","enabled"),k=!0,l=!0):(a(this).attr("selection","disabled"),k=!1)})},a.fn.scrollZoom.pointer=function(b,c,d){b&&"area"==c?a(d).css("cursor","crosshair"):a(d).css("cursor","move")},a.fn.scrollZoom.draw=function(b,c,d,e,f,g,h,i,j,k){var l=d-b,m=e-c;b-=h,c-=i,g&&a(f).append('<div class="scroom-square" id="square-'+b+"-"+c+'" positionx="'+j+'" positiony="'+k+'" style="left:'+b+"px; top:"+c+"px; width:"+l+"px; height:"+m+'px;"></div>'),a(f+" .scroom-square#square-"+b+"-"+c).css({width:l+"px",height:m+"px"})},a.fn.scrollZoom.remove=function(b){if(a("#"+b).length>0){var c=confirm("Would you like to delete this selected area!");1==c&&a("#"+b).remove()}}}(jQuery);